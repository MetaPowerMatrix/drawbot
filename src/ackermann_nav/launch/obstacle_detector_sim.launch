<?xml version="1.0"?>
<launch>
    <!-- 启动模拟激光雷达节点 -->
    <node name="lidar_simulator" pkg="ackermann_nav" type="lidar_simulator" output="screen">
        <!-- 激光雷达参数 -->
        <param name="num_readings" value="360" />
        <param name="laser_frequency" value="10.0" />
        <param name="range_min" value="0.05" />
        <param name="range_max" value="10.0" />
        <param name="angle_min" value="-3.14159" /> <!-- -PI -->
        <param name="angle_max" value="3.14159" />  <!-- PI -->
        
        <!-- 模拟参数 -->
        <param name="obstacle_distance" value="0.5" /> <!-- 设置小于安全距离，测试碰撞检测 -->
        <param name="obstacle_angle" value="0.0" />   <!-- 正前方 -->
        <param name="obstacle_width" value="0.5" />   <!-- 障碍物角度宽度 -->
        <param name="dynamic_obstacle" value="true" /> <!-- 动态障碍物 -->
        <param name="noise_stddev" value="0.02" />    <!-- 噪声标准差 -->
    </node>

    <!-- 启动障碍物检测节点 -->
    <node name="obstacle_detector" pkg="ackermann_nav" type="obstacle_detector" output="screen">
        <!-- 障碍物检测参数 -->
        <param name="safety_distance" value="0.20" /> <!-- 安全距离阈值（米）-->
        <param name="min_valid_range" value="0.05" /> <!-- 最小有效测量范围（米）-->
        <param name="max_valid_range" value="5.0" />  <!-- 最大有效测量范围（米）-->
        <param name="consecutive_readings" value="3" /> <!-- 连续检测阈值 -->
        <param name="ignore_rear" value="true" />      <!-- 是否忽略后方障碍物 -->
        <param name="front_angle_range" value="3.0" /> <!-- 前方检测扇区角度范围（弧度） -->
    </node>
    
    <!-- 可选：添加RVIZ可视化 -->
    <node name="rviz" pkg="rviz" type="rviz" args="-d $(find ackermann_nav)/rviz/obstacle_detector.rviz" required="false" />
</launch> 